<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/EmulatorPage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/EmulatorPage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useRef } from "react";
import "./EmulatorPage.css";

/**
 * Componente principal para carregar e iniciar o emulador de ROMs.
 * Permite que o usuário carregue arquivos ROM e comece a jogar.
 * 
 * @returns {JSX.Element} O componente do emulador com a interface de carregamento de ROM.
 */
const Emulator = () => {
  // Estado para controlar se o arquivo está sendo arrastado
  const [drag, setDrag] = useState(false);

  // Referência para o input de arquivo
  const inputRef = useRef(null);

  // Estado para saber se o jogo foi carregado
  const [gameLoaded, setGameLoaded] = useState(false);

  /**
   * Manipulador de evento para quando um arquivo é selecionado.
   * Processa o arquivo selecionado, determina o core necessário e carrega o jogo.
   * 
   * @param {Event} event O evento de mudança do arquivo.
   */
  const handleFileChange = async (event) => {
    const file = event.target.files[0];
    if (!file) return;

    // Divide o nome do arquivo para determinar a extensão
    const parts = file.name.split(".");
    const ext = parts.pop();

    // Importa a lógica do emulador dinamicamente e obtém o core apropriado
    const { getCore } = await import("./EmulatorLogic");
    const core = await getCore(ext, parts);

    loadGame(file, core, parts.shift());
  };

  /**
   * Carrega o jogo no emulador com as configurações apropriadas.
   * Define variáveis globais para a emulação e carrega o script do emulador.
   * 
   * @param {File} file O arquivo da ROM que será carregado.
   * @param {string} core O core de emulação a ser utilizado.
   * @param {string} gameName O nome do jogo.
   */
  const loadGame = (file, core, gameName) => {
    setGameLoaded(true);

    // Define variáveis globais para o emulador
    window.EJS_player = "#game";
    window.EJS_gameName = gameName;
    window.EJS_biosUrl = "";
    window.EJS_gameUrl = file;
    window.EJS_core = core;
    window.EJS_pathtodata = "data/";
    window.EJS_startOnLoaded = true;
    window.EJS_DEBUG_XX = false;
    window.EJS_disableDatabases = true;
    window.EJS_threads = false;

    // Carrega o script necessário para iniciar a emulação
    const script = document.createElement("script");
    script.src = "data/loader.js";
    document.body.appendChild(script);
  };

  return (
    &lt;div className="container">
      {!gameLoaded ? (
        &lt;>
          &lt;div className="top">
            &lt;h1>Carregue sua ROM !!Demo!!&lt;/h1>
            &lt;img src="./select.png" alt="Logo" className="logo" />
          &lt;/div>
          &lt;div
            className={`box ${drag ? "drag" : ""}`}
            onDragOver={() => setDrag(true)}
            onDragLeave={() => setDrag(false)}
          >
            &lt;input
              type="file"
              id="input"
              ref={inputRef}
              onChange={handleFileChange}
            />
            Arraste e solte o arquivo ROM ou clique aqui
          &lt;/div>
        &lt;/>
      ) : (
        &lt;div id="display">
          &lt;div id="game">&lt;/div>
        &lt;/div>
      )}
    &lt;/div>
  );
};

export default Emulator;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#%2522FileName%2522">"FileName"</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#Cadastro">Cadastro</a></li><li><a href="global.html#Creditos">Creditos</a></li><li><a href="global.html#Emulator">Emulator</a></li><li><a href="global.html#EmulatorPlus">EmulatorPlus</a></li><li><a href="global.html#HomePage">HomePage</a></li><li><a href="global.html#Layout">Layout</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#Navbar">Navbar</a></li><li><a href="global.html#getCore">getCore</a></li><li><a href="global.html#readRARContent">readRARContent</a></li><li><a href="global.html#start">start</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Feb 08 2025 05:08:06 GMT-0300 (Horário Padrão de Brasília)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
